Универсальный генератор сигналов.
Версия 0.17



Характеристики.
===============
						
Напряжение питания		12В
Амплитуда сигнала		0 — 5В
Смещение				-3 — 3В
Разрядность ЦАП			8бит
Частота дискретизации	1,78МГц


Форма сигнала:
	
	синус
	треугольник
	пила 
	обратная пила 
	ЭКГ 
	шум 
	меандр
	высокая частота
	ШИМ (прямоугольник с рег. скважностью)
	импульсы специальной формы
	ТВ сигнал(полосы, сетка, клетчатое поле)
	двухтональный синус(DTMF)
	свип-генератор(SWEEP)
	генератор цифровой последовательности(DPATTERN)
	

Частота:
    Синус, треугольник, пила, обратная пила, ЭКГ: 1Гц — 111.1КГц
    Меандр: 1Гц — 500.0Кгц
    Меандр(высокая частота): 125КГц, 250КГц, 500КГц, 1МГц, 2МГц, 4МГц, 8МГц.
	Двухтональный синус(DTMF): 1Гц - 10000Гц
	свип-генератор(SWEEP) 1Гц — 111.1КГц
	
ШИМ:
    1Гц-99КГц
    коэффициент заполнения 1% — 99%
    возможность внешней синхронизации

Импульсы специальной формы:
    Tмин. = Trise+Ton+Tfall+Toff = 8мкс
    Tмакс. = Trise+Ton+Tfall+Toff = 4000,0мс;
    число импульсов 1 — 65535
    возможность запуска внешним импульсом

DPATTERN:
	T0: 2мкс...1000.0мс
	период 1 импульса: 2*T0...254*T0
	число импульсов в последовательности: 1...128


У генератора имеется 2 выхода — A, D и вход — E. Сигналы в режимах синус, треугольник, пила, обратная пила, ЭКГ, шум, ТВ, PUSLSE, DTMF, SWEEP выводятся на выход A.
В режимах ШИМ, меандр, DPATTERN на выход — D. Этот выход имеет сигнал ТТЛ уровня.
Вход E используется для запуска режима PULSE и для стробирования в режиме ШИМ. На входе имеется защитный резистор? стабилитрон и подтяжка к питанию.
Все установленные параметры сохраняются в энергонезависимой памяти контроллера после запуска генератора.



Управление.
===========

Кнопка "Вкл./Выкл." - запуск/остановка генератора.
Кнопка "Уст." - вход/выход в настройки.
Кнопка "Реж." - переключение режима работы/настройки.
Кнопки "+"/"-" - установка значения параметра.

Для прошивки с энкодером управление заменяется следующим образом:

Кнопка "Вкл./Выкл.", "Реж." - короткое нажатие кнопки энкодера.
Кнопка "Уст." - долгое нажатие кнопки энкодера.
Кнопки "+"/"-"  - поворот ручки вправо/влево.



Режимы работы.
==============

После включения прибора на дисплее в верхней строке отображается текущий режим работы и состояние(включен или выключен). В нижней строке указываются дополнительные параметры.
При нажатии кнопки "Реж." происходит смена режима работы устройства.  При нажатии кнопки "Уст." включается режим установки параметров для текущего режима. 
Кнопка "Вкл./Выкл." запускает или выключает генератор. Переключатель "Фильтр." включает и выключает аналоговый фильтр на выходе A.


Синус (SINE), треугольник (TRIANGLE), пила (SAWTOOHWAVE), обратная пила (RSAWTOOHWAVE), ЭКГ (ECG).
--------------------------------------------------------------------------------------------------

Сигнал выбранной формы генерируется табличным методом. Т.к. с увеличением частоты уменьшается количество отсчетов, форма сигнала упрощается, появляются ступеньки. Для уменьшения подобного эффекта в схему добавлен аналоговый фильтр на 300КГц.
Для перехода в режим ввода частоты нужно нажать кнопку "Уст.". В этом режиме в  верхней строке показывается текущая частота, в нижней — шаг устанавливаемого числа. Значение устанавливается кнопками "+"/"-" , шаг можно изменить кнопкой "Реж.". По окончанию ввода нужно нажать кнопку "Уст.", после чего генератор перейдет в основной режим.


Шум (NOISE).
------------

Генерирует шум, не имеет настраиваемых параметров.


Меандр (SQUAREWAVE).
--------------------

Генерирует прямоугольные импульсы с коэффициентом заполнения ~50%. Имеет более высокую точность чем режим ШИМ. Однако из-за особенностей прямого синтеза частоты присутствует джиттер(дрожание фронтов) порядка ~1мкс.


Высокая частота (HIGH SPEED).
-----------------------------

Генерирует прямоугольные импульсы высокой частоты, с коэффициентом заполнения 50%. Имеет значения частоты: 125КГц, 250КГц, 500КГц, 1МГц, 2МГц, 4МГц, 8МГц.


ШИМ (PWM).
----------

Генерирует прямоугольные импульсы с регулируемым коэффициентом заполнения путем деления тактовой частоты.
В этом режиме есть 3 настраиваемых параметра, переход между ними осуществляется последовательно нажатием кнопки "Уст.".

F - частота устанавливается аналогично предыдущим режимам.

DC - коэффициент заполнения устанавливается в диапазоне 1-99% с шагом в 1%  кнопками "+"/"-".

EXT SYNC - Внешняя синхронизация может иметь 3 значения, которые выбираются кнопками "+"/"-" :
	NO – отсутствует, генератор будет работать все время после нажатия кнопки "Вкл./Выкл.".
	HIGH – генератор будет работать при наличии высокого уровня на входе E.
	LOW - генератор будет работать при наличии низкого уровня на входе E.
	
Во время работы генератора без внешней синхронизации(EXT SYNC=NO) возможно изменять частоту с коэф. заполнения нажатием кнопки "Уст.".


Импульсы специальной формы (PULSE).
-----------------------------------

Позволяет генерировать импульсы с заданным периодом линейного нарастания/спада уровня сигнала. Имеет 6 настраиваемых параметров, 

Trise — период нарастания импульса  2мкс — 1000мс;

Ton — период высокого уровня  2мкс — 1000мс;

Tfall — период спада импульса  2мкс — 1000мс;

Toff — период низкого уровня  2мкс — 1000мс; устанавливаются кнопками "+"/"-", шаг выбирается кнопкой "Реж.".

N – число импульсов, устанавливается кнопками "+"/"-", шаг выбирается кнопкой "Реж.".
	Диапазон 1 — 65535, после запуска генератор выдаст установленное число импульсов на выход A.
	ND – не определено, генератор будет работать все время после нажатия кнопки "Вкл./Выкл.". 
	
TRIGGER  — запуск генератора внешним импульсом на входе E. Значения,  выбираются кнопками "+"/"-"  :
	NO – отсутствует, генератор будет работать все время после нажатия кнопки "Вкл./Выкл.".
	RISE – после нажатия кнопки "Вкл./Выкл." генератор запустится только по фронту импульса на входе E. Во время ожидания в верхней строке дисплея будет показываться W:R
	FALL — после нажатия кнопки "Вкл./Выкл." генератор запустится только по спаду импульса на входе E. Во время ожидания в верхней строке дисплея будет показываться W:F

	
ТВ (TV).
--------

Генерирует аналоговый видеосигнал:
	вертикальные полосы(VERTICAL BARS);
	сетка(LATTICE);
	шахматное поле(CHESSBOARD).
	
Тип сигнала выбирается кнопкой "Уст.". Для правильной работы нужно установить смещение на 0В, амплитуду 5В. Выход A подключается к видеовходу телевизора.


Двухтональный синус(DTMF).
--------------------------

Генерирует двухтональный синусоидальный сигнал. Частота первого и второго тона отображается в нижней строке дисплея. Для установки частот нажать кнопку "Уст.".


Свип-генератор(SWEEP).
----------------------

Генерирует синусоидальный сигнал, с линейно изменяющейся частотой на выходе A. Выход D используется для синхронизации с осциллографом. В начале каждого цикла на выход D подается лог. 1, по завершению лог. 0. 

Параметры:
Fstart - начальное значение частоты;
Fstop - конечное значение частоты;
Finc - скорость, изменения частоты 


Генератор цифровой последовательности(DPATTERN).
------------------------------------------------

Генерирует последовательность цифровых импульсов на выходе D по заранее заданному шаблону. Данный генератор может пригодиться при тестировании различных однопроводных протоколов. Примерный аналог - генератор DPATTERN из симулятора PROTEUS. Активный уровень – лог.0, т.е. в выключенном состоянии выход D подтянут к питанию.

Настройка.

T0 - время единичного значения периода. После установки T0 нужно повторно нажать кнопку "Уст.". прибор перейдет в режим ввода шаблона.
В верхней строке дисплея выводится последовательность импульсов, в нижней строке - порядковый номер импульса и его период. Для перехода между импульсами используются кнопки "+"/"-" . 
Каждый импульс задается двумя полупериодами, которые можно настроить по отдельности. Для этого нужно нажать кнопку "Реж.". После этого на дисплее появиться символ '>' который указывает на настраиваемый полупериод, после чего кнопками "+"/"-"  можно задать значение. Для переключения между полупериодами используется кнопка "Реж.".
Длительность и полярность сигнала на выходе обозначается числом единичных периодов и буквами L или H соответственно. Например, 1L5H означает, что в течении времени 1*T0 на выходе будет лог. 0, а затем 5*T0 лог 1. 
Помимо цифровых значений в шаблоне может быть ещё 2 команды, которые всегда ставятся в конце последовательности: BRK и REP. Команда BRK - команда остановки генератора. Она используется, если шаблон необходимо воспроизвести 1 раз.
Команда REP обозначает повтор, т. е. при её выполнении генератор переходит на начало последовательности. В этом случае шаблон будет воспроизводится по кругу, отключение возможно вручную кнопкой старт. 
Для выхода из режима настройки используется кнопка "Уст.".

Примечание: после сброса установок генератора шаблон не перезаписываются.



Прошивка.
=========

На данный момент имеется 2 версии прошивки:
	ndds.hex для схемы с кнопками;
	ndds_enc.hex для схемы с энкодером вместо кнопок.
	
Фьюз биты: LOW = 0xFF, HIGH  = 0xD9.
Будьте осторожны, при последующей прошивке контроллер может не определяться без кварцевого резонатора!


Integrator.sb@gmail.com

2018
